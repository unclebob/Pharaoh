/*  * random.c -- Contains functions for delivering random number sequences for various types  *                    of probability distributions.  */  #include <std.h>#include <quickdraw.h>#include <osutil.h>#include <math.h>LOCAL BOOL rinit = NO;/*«URandom»  * Generate uniformly distributed random numbers between [a,b)   */DOUBLE URandom(a,b)DOUBLE a,b;	{	LOCAL ULONG x = 0;	/* for the R.R.Coveyou quadratic method  Knuth vol. 2 */	FAST UCOUNT r1,r2;	DOUBLE r;		if (b < a)		{	/* swap */		r=b;		b=a;		a=r;		}			if (!rinit)		{		rinit = YES;		GetDateTime(&randSeed);		x = (randSeed & ~3L) | 2; /* make sure x mod 4 = 2 */		}	x *= x+1;	/* quadratic method */	r1=Random();	r2=Random();	r=r1*r2+x;	r/= 4294967295.0;	return(r*(b-a)+a);	}	/*«GRandom»  * GRandom(m,s) -- Generate a Gaussian (normal) random number sequence, whose mean  *                            is m, and sigma is s.  *  *				Polar method for normal deviates, Knuth bol. 2, pp. 104, 113  */    DOUBLE GRandom(m,sigma)  DOUBLE m,sigma;  	{	DOUBLE v1, v2, s, u;		do		{		v1 = URandom(-1., 1.);		v2 = URandom(-1., 1.);		s = v1*v1 + v2*v2;		} while (s >= 1);			u = sqrt(-2*log(s)/s);	return(m+sigma*v1*u);	}	/*«ERandom»  * ERandom(m) -- Generates an exponential random number sequence with a mean of 'm'.  *                         using the method in Knuth, Vol. 2, p. 114.  */  DOUBLE ERandom(m)DOUBLE m;	{	DOUBLE u;		while((u=URandom(0., 1.)) == 0);	/* u can't be zero! */	return(-log(u)*m);	}	/*«ARandom»  * ARandom(mean, sigma) -- This is a Gaussian distribution which will not go negative  */  DOUBLE ARandom(mean, sigma)DOUBLE mean, sigma;	{	DOUBLE x;		while ((x=GRandom(mean, sigma)) < 0);	return(x);	}		/*«MaxRandom»  * MaxRandom(n, a, b); -- after n attempts, return the largest random value between a and b  */  DOUBLE MaxRandom(n, a, b)FAST COUNT n;DOUBLE a, b;	{	DOUBLE curMax = a, r;		while (n--)		{		r = URandom(a,b);		curMax = max(r, curMax);		}	return(curMax);	}	