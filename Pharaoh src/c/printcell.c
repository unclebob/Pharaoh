#include <std.h>#include <math.h>#include <quickdraw.h>#include <textedit.h>#include <font.h>/*  * PrintCell -- This function prints a string in a rectangle.  It is something like TextBox  */  VOID PrintCell(s,r)TEXT *s;Rect *r;	{	FontInfo fi;	Rect textRect;	GrafPtr p;	COUNT textRight;	/* the rightmost position of the text */	COUNT length;		/* number of chars in string */		GetPort(&p); 	/* if the rect is not in the visRgn, then forget it */		textRect.top = r->top+1;	textRect.left = r->left+1;	textRight = textRect.left + TextWidth(s, 0, length = strlen(s))+1;	textRect.right = max(r->right-2, textRight);	textRect.bottom = r->bottom;	if (!RectInRgn(&textRect, p->visRgn))		return;	EraseRect(&textRect);	GetFontInfo(&fi);	MoveTo(r->left+1, r->top+fi.ascent-1);	DrawText(s, 0, length);	return;	}	/*  * PrintInt -- This function prints a floating point number as an integer if possible  */  VOID PrintInt(f,r)DOUBLE f;Rect *r;	{	TEXT buf[100];	FAST UCOUNT tWidth, rWidth;	GrafPtr p;		GetPort(&p); 	/* if the rect is not in the visRgn, then forget it */	if (!RectInRgn(r, p->visRgn))		return;				rWidth = r->right - r->left;	ftoa(floor(f), buf, 0, 1);	tWidth = TextWidth(buf, 0, strlen(buf));		if (tWidth >= rWidth)		ftoa(f, buf, 2, 2);	PrintCell(buf, r);	}	/*  * PrintFloat -- This function prints a floating point number.  */  VOID PrintFloat(f,r)DOUBLE f;Rect *r;	{	TEXT buf[100];	FAST UCOUNT tWidth, rWidth, precision;	GrafPtr p;		GetPort(&p); 	/* if the rect is not in the visRgn, then forget it */	if (!RectInRgn(r, p->visRgn))		return;				rWidth = r->right - r->left;		if (f >= 1000) precision = 0;	else if (f >= 100) precision = 1;	else if (f >= 10) precision = 2;	else if (f >= 1) precision = 3;	else precision = 4;		ftoa(f, buf, precision, 1);	tWidth = TextWidth(buf, 0, strlen(buf));		if (tWidth >= rWidth)		ftoa(f, buf, 2, 2);	PrintCell(buf, r);	}		/* ÇCellRectÈ  * CellRect(r1, r2, title) -- Paint a rectangle around the two specified cells, and title it.  *                                        if title is NULL, then don't draw the title.  */  VOID CellRect(r1, r2, title)FAST Rect *r1, *r2;FAST TEXT *title;	{	Rect theRect, titleRect;	FontInfo fi;	FAST COUNT fontHeight, center, titleLength;		theRect.top = r1->top;	theRect.left = r1->left-1;	theRect.bottom = r2->bottom+1;	theRect.right = r2->right-1;		if (title)		{		GetFontInfo(&fi);		fontHeight = fi.ascent + fi.descent;		titleRect.top = theRect.top+1;		titleRect.bottom = titleRect.top + fontHeight;		theRect.top += fontHeigth/2;		center = (theRect.right - theRect.left)/2 + theRect.left;		titleLength = TextWidth(title, 0, strlen(title))+4;		titleRect.left = center-titleLength/2;		titleRect.right = center+titleLength/2;		}		FillRect(&theRect, ltGray);	FrameRect(&theRect);		if (title)		{		TextBox(title, (LONG)strlen(title), &titleRect, teJustCenter);		FrameRect(&titleRect);		}	}